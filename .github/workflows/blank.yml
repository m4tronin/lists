name: Update community.txt

on:
  schedule:
    # Раз в сутки в 00:00 UTC (настрой по вкусу, см. crontab.guru)
    - cron: '0 0 * * *'
  workflow_dispatch:  # Для ручного запуска

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Скачать и сохранить файл
        run: |
          curl -s https://raw.githubusercontent.com/1andrevich/Re-filter-lists/main/community.lst -o community.txt
      
      - name: Проверить изменения
        run: |
          if git diff --quiet community.txt; then
            echo "Нет изменений"
            exit 0
          fi
      
      - name: Коммит и пуш
        run: |
          git config user.name "GitHub Action"
          git config user.email "action@github.com"
          git add community.txt
          git commit -m "Обновить community.txt из upstream [$(date +'%Y-%m-%d')]"
          git push
